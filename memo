req는 client에서 서버로 요청을 보내는 것이고
req를 보낼 때도 여러가지 데이터를 실어서 보낼 수 있다.



res는 sertver에서 client로 응답을 하는 것
서버에서 데이터를 담아서 res에 담아준다.


로그인 인증을 구현하려면..?

1. 서버에서 지금 로그인 한 사람이 누구인지?

2. 유효한 사용자인지 확인하기

3.


??
클라이언트가 서버에 로그인 요청을 보내면
서버는 로그인 한 사람이 db에 있는 유효한 사용자인지 확인한다

유효한 샤용자라면  acces토큰을 발급해준다,

클라는 토큰을 갖고있다가 api가 필요할 때 토큰을 같이 보내준다.
토큰이 유효하면 서버는 api를 보내준다.

그래서 이렇게 로그인 한 유저가 있는지 없는지를 서버가
관리하고 있는거르 stateful 한거라고 한다.

토큰을 생성 후에는 클라에 넘겨주기만 하면되는데 방법은 크게 두가지가있다

쿠키 or res로 넘겨주기.


** 몽고 db && 몽구스 **
몽고DB란?

MongoDB는 C++로 작성된 오픈소스 문서지향적 크로스 플랫폼 데이터베이스이며,
뛰어난 확장성과 성능을 자랑한다.

 몽구스의 대표적인 장점!!
▶️ 강제 스키마(schema)의 부활
▶️ populate
▶️ 프로미스와 콜백 사용 가능
▶️ 편리한 쿼리 빌더


model이란?

스키마를 감싸주는 역할을 한다.(스키마는 모델이다)


몽구스는 사용자가 작성한 스키마를 기준으로 데이터를 DB에 넣기 전에 먼저 검사합니다.
스키마에 어긋나는 데이터가 있으면 에러를 발생시킵니다.
즉, 테이블과 어느 정도 비슷한 역할을 합니다. 또한 스키마를 설정할 때 인덱스까지 같이 걸어둘 수도 있습니다.
기본값도 설정해줄 수 있고요. 
구조에 관한 편의 기능들을 하나로 모아두었다고 생각하시면 됩니다.

스키마를 구성할 때 trim 이라는 속성이 있다
예를들어 shim sungbo 라는 공백의 문자열이 발생했을 때,
trim: true 속성은 위 문자열을 shimsungbo로 바꿔준다.

?? 쿼리란?

쿼리는 요청이다. 클라이언트가 서버(db)에게 요청하는 것이다.
흔히들 '쿼리문을 작성한다' 라는 말은
데이터베이스에서 원하는 정보를 가져오는 코드 라고 해석한다.



미들웨어란?
미들웨어는 양 쪽을 연결하여 데이터를 주고받을 수 있도록 중간에서 
매개 역할을 하는 소프트웨어, 네트워크를 통해서 연결된 여러 개의 컴퓨터에 있는 많은 프로세스들에게
어떤 서비스를 사용할 수 있도록 연결해주는 소프트웨어를 말합니다.


body-parser란?

body-parser는 미들웨어이다. 즉, 요청(request)과 응답(response) 
사이에서 공통적인 기능을 수행하는 소프트웨어이다.
그렇다면 역할은 무엇일까? 바로 요청의 본문을 지정한 형태로 파싱해주는 미들웨어이다.


비밀정보 보호?
우리가 개발을 할때 두가지 환경에서 개발을 할 수 있다.
1. LOCAL(development)환경 2. 배포(deploy) 후 production 환경

위의 방식으로 나누는 이유는 develop 모드 일때는 연결 된 mpngo를 읽어올 수 있다.
하지만 배포 후 환경에서는 mongo를 읽을 수 없고 따로 설정을 해주어야한다.

몽고db와 연결할 때 아이디와 패스워드가 공개된다.


auth 기능 만들기

현재 서버에는 토큰을 클라이언트에는 cookie 형태로
토큰을 만들어 놓은 상태.

1. cookie에서 저장 된 token을 server에서 가져와서 복호화를 한다.


로그아웃?

로그아웃 라우터만들고
데이터베이스에서 그 유저의 토큰을 지워준다.

토큰을 지워야하는 이유는?



cors란 무엇일까?
cross origin resource sharing의 약자이다.

클라와 서버의 포트가 다르다는것은
origin이 다르다는 것이다.

origin이라는것은 데이터의 출처를 뜻한다.
오리진이 다르다는것은 조심해서 다뤄야한다.

극단적으로 생각하면
naver.com
google.com

origin이 다를 때 데이터를 꺼내가는것을 허락한다면??
네이버에서 구글에 있는 데이터를 가져가도 된다가 됩니다.
그래서 웹 창시자는 origin이 다르면 무조건 막는다. 당연한 이야기다.

